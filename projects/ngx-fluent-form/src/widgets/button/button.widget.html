<ng-template let-control="control" let-schema="schema" let-model="model" [fluentContextGuard]="contextGuard">
  <ng-container *ngIf="schema.type === 'link'">
    <a
      *ngIf="!(schema.hidden | call: model:schema:control)"
      nz-button
      [disabled]="schema.disabled | call: model:schema:control"
      [fluentBinding]="{ schema, control }"
      [ngClass]="schema.class"
      [ngStyle]="schema.style"
      [nzBlock]="schema.block"
      [nzDanger]="schema.danger | call: model:schema:control"
      [nzGhost]="schema.ghost | call: model:schema:control"
      [nzLoading]="schema.loading | call: model:schema:control"
      [nzShape]="schema.shape!"
      [nzSize]="schema.size!"
      [nzType]="schema.type">
      <ng-container [ngTemplateOutlet]="buttonContentTemplate"></ng-container>
    </a>
  </ng-container>

  <ng-container *ngIf="schema.type !== 'link'">
    <button
      *ngIf="!(schema.hidden | call: model:schema:control)"
      nz-button
      [attr.type]="schema.mode"
      [disabled]="schema.disabled | call: model:schema:control"
      [fluentBinding]="{ schema, control }"
      [ngClass]="schema.class"
      [ngStyle]="schema.style"
      [nzBlock]="schema.block"
      [nzDanger]="schema.danger | call: model:schema:control"
      [nzGhost]="schema.ghost | call: model:schema:control"
      [nzLoading]="schema.loading | call: model:schema:control"
      [nzShape]="schema.shape!"
      [nzSize]="schema.size!"
      [nzType]="schema.type ?? null">
      <ng-container [ngTemplateOutlet]="buttonContentTemplate"></ng-container>
    </button>
  </ng-container>

  <ng-template #buttonContentTemplate>
    <span
      *ngIf="helper.icon | invoke: schema.icon as icon"
      nz-icon
      [nzRotate]="icon.rotate ?? 0"
      [nzSpin]="icon.spin"
      [nzTheme]="icon.theme ?? 'outline'"
      [nzType]="icon.type"></span>
    <ng-container *ngIf="schema.content">
      <ng-container *nzStringTemplateOutlet="schema.content">{{ schema.content }}</ng-container>
    </ng-container>
  </ng-template>
</ng-template>
