<!-- 组件模板 -->
<!-- 根据 schema.type 来输出不同的控件 -->
<!-- @param control FormControl -->
<!-- @param schema  组件的图示 -->
<!-- @param model   当前模型值 -->
<ng-template #controlTemplate let-control="control" let-schema="schema" let-model="model" let-classful="classful">
  <ng-container [ngSwitch]="schema.type">
    <ng-container *ngSwitchCase="'input'">
      <ng-container *ngIf="schema.autocomplete as autocomplete">
        <input
          nz-input
          [attr.id]="schema.id"
          [attr.maxlength]="schema.length?.max ?? schema.length"
          [attr.minlength]="schema.length?.min ?? schema.length"
          [fluentBinderSchema]="schema"
          [fluentBinderControl]="control"
          [ngClass]="classful ? schema.class : null"
          [ngStyle]="schema.style"
          [formControl]="control"
          [nzAutocomplete]="autocompleteCmp"
          [placeholder]="schema.placeholder ?? ''"
          [type]="schema.subtype ?? 'text'"
          [autofocus]="schema.autofocus"
          [readonly]="schema.readonly | call: model : schema : control"
          [nzSize]="schema.size"
          [nzBorderless]="schema.borderless">
        <nz-autocomplete
          #autocompleteCmp
          [compareWith]="autocomplete.compare"
          [nzBackfill]="autocomplete.backfill"
          [nzDataSource]="autocomplete.options"
          [nzWidth]="autocomplete.width"></nz-autocomplete>
      </ng-container>
      <input
        *ngIf="!schema.autocomplete"
        nz-input
        [attr.id]="schema.id"
        [attr.maxlength]="schema.length?.max ?? schema.length"
        [attr.minlength]="schema.length?.min ?? schema.length"
        [fluentBinderSchema]="schema"
        [fluentBinderControl]="control"
        [formControl]="control"
        [ngClass]="classful ? schema.class : null"
        [ngStyle]="schema.style"
        [placeholder]="schema.placeholder ?? ''"
        [type]="schema.subtype ?? 'text'"
        [autofocus]="schema.autofocus"
        [readonly]="schema.readonly | call: model : schema : control"
        [nzSize]="schema.size"
        [nzBorderless]="schema.borderless">
    </ng-container>

    <ng-container *ngSwitchCase="'textarea'">
      <ng-container *ngIf="schema.autocomplete as autocomplete">
        <textarea
          nz-input
          [attr.id]="schema.id"
          [attr.maxlength]="schema.length?.max ?? schema.length"
          [attr.minlength]="schema.length?.min ?? schema.length"
          [fluentBinderSchema]="schema"
          [fluentBinderControl]="control"
          [formControl]="control"
          [ngClass]="classful ? schema.class : null"
          [ngStyle]="schema.style"
          [nzAutocomplete]="autocompleteCmp"
          [nzAutosize]="schema.autosize ?? {}"
          [placeholder]="schema.placeholder ?? ''"
          [rows]="schema.rows"
          [autofocus]="schema.autofocus"
          [readonly]="schema.readonly | call: model : schema : control"
          [nzSize]="schema.size"
          [nzBorderless]="schema.borderless"></textarea>
        <nz-autocomplete
          #autocompleteCmp
          [compareWith]="autocomplete.compare"
          [nzBackfill]="autocomplete.backfill"
          [nzDataSource]="autocomplete.options"
          [nzWidth]="autocomplete.width"></nz-autocomplete>
      </ng-container>
      <textarea
        *ngIf="!schema.autocomplete"
        nz-input
        [attr.id]="schema.id"
        [attr.maxlength]="schema.length?.max ?? schema.length"
        [attr.minlength]="schema.length?.min ?? schema.length"
        [fluentBinderSchema]="schema"
        [fluentBinderControl]="control"
        [formControl]="control"
        [ngClass]="classful ? schema.class : null"
        [ngStyle]="schema.style"
        [nzAutosize]="schema.autosize ?? {}"
        [placeholder]="schema.placeholder ?? ''"
        [rows]="schema.rows"
        [autofocus]="schema.autofocus"
        [readonly]="schema.readonly | call: model : schema : control"
        [nzSize]="schema.size"
        [nzBorderless]="schema.borderless"></textarea>
    </ng-container>

    <ng-container *ngSwitchCase="'number'">
      <nz-input-number
        #cmp
        [fluentBinder]="cmp"
        [fluentBinderSchema]="schema"
        [fluentBinderControl]="control"
        [formControl]="control"
        [ngClass]="classful ? schema.class : null"
        [ngStyle]="schema.style"
        [nzId]="schema.id"
        [nzMax]="schema.max ?? infinity"
        [nzMin]="schema.min ?? -infinity"
        [nzPlaceHolder]="schema.placeholder ?? ''"
        [nzPrecision]="schema.precision?.value ?? (schema.precision | typeof: 'number') ? schema.precision : ''"
        [nzPrecisionMode]="schema.precision?.mode"
        [nzStep]="schema.step ?? 1"
        [nzAutoFocus]="schema.autofocus"
        [nzReadOnly]="schema.readonly | call: model : schema : control"
        [nzSize]="schema.size"
        [nzBorderless]="schema.borderless">
      </nz-input-number>
    </ng-container>

    <ng-container *ngSwitchCase="'date'">
      <nz-date-picker
        #cmp
        [fluentBinder]="cmp"
        [fluentBinderSchema]="schema"
        [fluentBinderControl]="control"
        [formControl]="control"
        [ngClass]="classful ? schema.class : null"
        [ngStyle]="schema.style"
        [nzAllowClear]="schema.clearable"
        [nzFormat]="schema.format"
        [nzId]="schema.id"
        [nzInline]="schema.inline"
        [nzMode]="schema.mode"
        [nzPlaceHolder]="schema.placeholder"
        [nzShowTime]="schema.time"
        [nzBackdrop]="schema.backdrop"
        [nzPlacement]="schema.placement ?? 'bottomLeft'"
        [nzSuffixIcon]="schema.suffixIcon ?? 'calendar'"
        [nzAutoFocus]="schema.autofocus"
        [nzInputReadOnly]="schema.readonly | call: model : schema : control"
        [nzSize]="schema.size"
        [nzBorderless]="schema.borderless"
        [nzShowToday]="schema.today ?? true"
        [nzShowNow]="schema.now ?? true">
      </nz-date-picker>
    </ng-container>

    <ng-container *ngSwitchCase="'range'">
      <nz-range-picker
        #cmp
        [fluentBinder]="cmp"
        [fluentBinderSchema]="schema"
        [fluentBinderControl]="control"
        [formControl]="control"
        [ngClass]="classful ? schema.class : null"
        [ngStyle]="schema.style"
        [nzAllowClear]="schema.clearable"
        [nzFormat]="schema.format"
        [nzId]="schema.id"
        [nzInline]="schema.inline"
        [nzMode]="schema.mode"
        [nzPlaceHolder]="schema.placeholder"
        [nzShowTime]="schema.time"
        [nzShowTime]="schema.time"
        [nzBackdrop]="schema.backdrop"
        [nzPlacement]="schema.placement ?? 'bottomLeft'"
        [nzSuffixIcon]="schema.suffixIcon ?? 'calendar'"
        [nzAutoFocus]="schema.autofocus"
        [nzInputReadOnly]="schema.readonly | call: model : schema : control"
        [nzSize]="schema.size"
        [nzBorderless]="schema.borderless"
        [nzShowToday]="schema.today ?? true"
        [nzShowNow]="schema.now ?? true"
        [nzSeparator]="schema.separator">
      </nz-range-picker>
    </ng-container>

    <ng-container *ngSwitchCase="'time'">
      <nz-time-picker
        #cmp
        [fluentBinder]="cmp"
        [fluentBinderSchema]="schema"
        [fluentBinderControl]="control"
        [formControl]="control"
        [ngClass]="classful ? schema.class : null"
        [ngStyle]="schema.style"
        [nzAllowEmpty]="schema.clearable"
        [nzFormat]="schema.format ?? 'HH:mm:ss'"
        [nzHourStep]="schema.step?.hour"
        [nzId]="schema.id"
        [nzMinuteStep]="schema.step?.minute"
        [nzPlaceHolder]="schema.placeholder"
        [nzSecondStep]="schema.step?.second"
        [nzAutoFocus]="schema.autofocus"
        [nzSize]="schema.size"
        [nzBorderless]="schema.borderless"
        [nzBackdrop]="schema.backdrop"
        [nzSuffixIcon]="schema.suffixIcon ?? 'clock-circle'">
      </nz-time-picker>
    </ng-container>

    <ng-container *ngSwitchCase="'toggle'">
      <nz-switch
        #cmp
        [nzId]="schema.id"
        [fluentBinder]="cmp"
        [fluentBinderSchema]="schema"
        [fluentBinderControl]="control"
        [formControl]="control"
        [ngClass]="classful ? schema.class : null"
        [ngStyle]="schema.style"
        [nzCheckedChildren]="schema.placeholder?.[0]"
        [nzUnCheckedChildren]="schema.placeholder?.[1]"
        [nzSize]="schema.size">
      </nz-switch>
    </ng-container>

    <ng-container *ngSwitchCase="'select'">
      <nz-select
        #cmp
        [fluentBinder]="cmp"
        [fluentBinderSchema]="schema"
        [fluentBinderControl]="control"
        [formControl]="control"
        [ngClass]="classful ? schema.class : null"
        [ngStyle]="schema.style"
        [nzAllowClear]="schema.clearable"
        [nzId]="schema.id"
        [nzMaxMultipleCount]="schema.limit ?? infinity"
        [nzMode]="schema.mode ?? 'default'"
        [nzPlaceHolder]="schema.placeholder"
        [nzShowSearch]="schema.searchable"
        [nzBackdrop]="schema.backdrop"
        [nzBorderless]="schema.borderless"
        [nzAutoFocus]="schema.autofocus"
        [nzShowArrow]="schema.arrow ?? (!schema.mode || schema.mode === 'default')"
        [nzSize]="schema.size"
        [nzSuffixIcon]="schema.suffixIcon">
        <nz-option
          *ngFor="let option of schema.options"
          [nzDisabled]="option[schema.config?.disabledProperty ?? 'disabled']"
          [nzLabel]="option[schema.config?.labelProperty ?? 'label']"
          [nzValue]="option[schema.config?.valueProperty ?? 'value']">
        </nz-option>
      </nz-select>
    </ng-container>

    <ng-container *ngSwitchCase="'cascader'">
      <nz-cascader
        #cmp
        [fluentBinder]="cmp"
        [fluentBinderSchema]="schema"
        [fluentBinderControl]="control"
        [formControl]="control"
        [ngClass]="classful ? schema.class : null"
        [ngStyle]="schema.style"
        [nzAllowClear]="schema.clearable ?? true"
        [nzAutoFocus]="schema.autofocus"
        [nzBackdrop]="schema.backdrop"
        [nzExpandIcon]="schema.expandIcon ?? ''"
        [nzExpandTrigger]="schema.trigger"
        [nzLabelProperty]="schema.config?.labelProperty ?? 'label'"
        [nzLoadData]="schema.loadData"
        [nzOptions]="schema.options"
        [nzPlaceHolder]="schema.placeholder ?? ' '"
        [nzShowArrow]="schema.arrow ?? true"
        [nzShowSearch]="schema.searchable"
        [nzSize]="schema.size"
        [nzSuffixIcon]="schema.suffixIcon ?? 'down'"
        [nzValueProperty]="schema.config?.valueProperty ?? 'value'">
      </nz-cascader>
    </ng-container>

    <ng-container *ngSwitchCase="'tree-select'">
      <nz-tree-select
        #cmp
        [nzId]="schema.id"
        [fluentBinder]="cmp"
        [fluentBinderSchema]="schema"
        [fluentBinderControl]="control"
        [formControl]="control"
        [ngClass]="classful ? schema.class : null"
        [ngStyle]="schema.style"
        [nzAllowClear]="schema.clearable ?? true"
        [nzBackdrop]="schema.backdrop"
        [nzShowIcon]="schema.icon"
        [nzShowSearch]="schema.searchable"
        [nzSize]="schema.size"
        [nzCheckable]="schema.checkable"
        [nzCheckStrictly]="schema.checkable?.strict"
        [nzShowExpand]="schema.expandIcon ?? true"
        [nzExpandedIcon]="schema.expandIcon"
        [nzShowLine]="schema.line"
        [nzAsyncData]="schema.async"
        [nzNodes]="schema.options"
        [nzDefaultExpandAll]="schema.expandAll"
        [nzExpandedKeys]="schema.expandedKeys"
        [nzMultiple]="schema.multiple"
        [nzVirtualHeight]="schema.virtual?.height"
        [nzVirtualItemSize]="schema.virtual?.itemSize ?? 28"
        [nzVirtualMaxBufferPx]="schema.virtual?.maxBufferPx ?? 500"
        [nzVirtualMinBufferPx]="schema.virtual?.minBufferPx ?? 28"></nz-tree-select>
    </ng-container>

    <ng-container *ngSwitchCase="'slider'">
      <nz-slider
        #cmp
        [fluentBinder]="cmp"
        [fluentBinderSchema]="schema"
        [fluentBinderControl]="control"
        [formControl]="control"
        [ngClass]="classful ? schema.class : null"
        [ngStyle]="schema.style"
        [nzIncluded]="schema.included ?? true"
        [nzMax]="schema.max ?? 100"
        [nzMin]="schema.min"
        [nzRange]="schema.range"
        [nzStep]="schema.step ?? 1"
        [nzDots]="schema.dots"
        [nzVertical]="schema.vertical"
        [nzReverse]="schema.reverse">
      </nz-slider>
    </ng-container>

    <ng-container *ngSwitchCase="'radio'">
      <nz-radio-group
        #cmp
        [fluentBinder]="cmp"
        [fluentBinderSchema]="schema"
        [fluentBinderControl]="control"
        [formControl]="control"
        [ngClass]="classful ? schema.class : null"
        [ngStyle]="schema.style"
        [nzButtonStyle]="schema.button"
        [nzSize]="schema.size">
        <ng-container *ngFor="let option of schema.options">
          <label
            *ngIf="schema.button"
            nz-radio-button
            [nzValue]="option[schema.config?.valueProperty ?? 'value']">
            {{ option[schema.config?.labelProperty ?? 'label'] }}
          </label>
          <label
            *ngIf="!schema.button"
            nz-radio
            [nzValue]="option[schema.config?.valueProperty ?? 'value']">
            {{ option[schema.config?.labelProperty ?? 'label'] }}
          </label>
        </ng-container>
      </nz-radio-group>
    </ng-container>

    <ng-container *ngSwitchCase="'checkbox'">
      <label
        #cmp
        nz-checkbox
        [fluentBinder]="cmp"
        [fluentBinderSchema]="schema"
        [fluentBinderControl]="control"
        [formControl]="control"
        [ngClass]="classful ? schema.class : null"
        [ngStyle]="schema.style"
        [nzId]="schema.id"
        [nzAutoFocus]="schema.autofocus"
        [nzIndeterminate]="schema.indeterminate">{{ schema.content }}</label>
    </ng-container>

    <ng-container *ngSwitchCase="'checkbox-group'">
      <nz-checkbox-group
        #cmp
        [fluentBinder]="cmp"
        [fluentBinderSchema]="schema"
        [fluentBinderControl]="control"
        [formControl]="control"
        [ngClass]="classful ? schema.class : null"
        [ngStyle]="schema.style">
      </nz-checkbox-group>
    </ng-container>

    <ng-container *ngSwitchCase="'rate'">
      <nz-rate
        #cmp
        [fluentBinder]="cmp"
        [fluentBinderSchema]="schema"
        [fluentBinderControl]="control"
        [formControl]="control"
        [ngClass]="classful ? schema.class : null"
        [ngStyle]="schema.style"
        [nzAllowClear]="schema.clearable ?? true"
        [nzAllowHalf]="schema.half"
        [nzCharacter]="schema.character"
        [nzCount]="schema.count ?? 5"
        [nzTooltips]="schema.tooltips ?? []"
        [nzAutoFocus]="schema.autofocus"></nz-rate>
    </ng-container>

    <ng-container *ngSwitchCase="'input-group'">
      <nz-input-group
        #cmp
        nzCompact
        [fluentBinder]="cmp"
        [fluentBinderSchema]="schema"
        [ngClass]="classful ? schema.class : null"
        [ngStyle]="schema.style"
        [nzAddOnAfter]="schema.after?.icon ? null : schema.after"
        [nzAddOnAfterIcon]="schema.after?.icon"
        [nzAddOnBefore]="schema.before?.icon ? null : schema.before"
        [nzAddOnBeforeIcon]="schema.before?.icon"
        [nzPrefix]="schema.prefix?.icon ? null : schema.prefix"
        [nzPrefixIcon]="schema.prefix?.icon"
        [nzSize]="schema.size"
        [nzSuffix]="schema.suffix?.icon ? null : schema.suffix"
        [nzSuffixIcon]="schema.suffix?.icon">
        <ng-container
          *ngFor="let subschema of schema.schemas"
          [ngTemplateOutlet]="composableControlTemplate"
          [ngTemplateOutletContext]="{ control: (subschema.name | control: control) ?? control, schema: subschema, model: model, classful: true }">
        </ng-container>
      </nz-input-group>
    </ng-container>

    <ng-container *ngSwitchCase="'text'">
      <nz-form-text
        #cmp
        [fluentBinder]="cmp"
        [fluentBinderSchema]="schema"
        [ngClass]="classful ? schema.class : null"
        [ngStyle]="schema.style">
        <ng-container *nzStringTemplateOutlet="schema.content">{{ schema.content }}</ng-container>
      </nz-form-text>
    </ng-container>

    <ng-container *ngSwitchCase="'button-group'">
      <nz-button-group
        #cmp
        [fluentBinder]="cmp"
        [fluentBinderSchema]="schema"
        [ngClass]="classful ? schema.class : null"
        [ngStyle]="schema.style"
        [nzSize]="schema.size">
        <ng-container
          *ngFor="let subschema of schema.schemas"
          [ngTemplateOutlet]="controlTemplate"
          [ngTemplateOutletContext]="{ control: control, schema: subschema, model: model, classful: true }">
        </ng-container>
      </nz-button-group>
    </ng-container>

    <ng-container *ngSwitchCase="'button'">
      <ng-container *ngIf="schema.subtype === 'link'">
        <a
          *ngIf="!(schema.hidden | call: model : schema : control)"
          nz-button
          [attr.id]="schema.id"
          [disabled]="schema.disabled | call: model : schema : control"
          [fluentBinderSchema]="schema"
          [ngClass]="classful ? schema.class : null"
          [ngStyle]="schema.style"
          [nzBlock]="schema.block"
          [nzDanger]="schema.danger | call: model : schema : control"
          [nzGhost]="schema.ghost | call: model : schema : control"
          [nzLoading]="schema.loading | call: model : schema : control"
          [nzShape]="schema.shape"
          [nzSize]="schema.size"
          [nzType]="schema.subtype">
          <ng-container *ngTemplateOutlet="buttonContentTemplate; context: { schema }"></ng-container>
        </a>
      </ng-container>
      <ng-container *ngIf="schema.subtype !== 'link'">
        <button
          *ngIf="!(schema.hidden | call: model : schema : control)"
          nz-button
          [attr.id]="schema.id"
          [attr.type]="schema.mode"
          [disabled]="schema.disabled | call: model : schema : control"
          [fluentBinderSchema]="schema"
          [ngClass]="classful ? schema.class : null"
          [ngStyle]="schema.style"
          [nzBlock]="schema.block"
          [nzDanger]="schema.danger | call: model : schema : control"
          [nzGhost]="schema.ghost | call: model : schema : control"
          [nzLoading]="schema.loading | call: model : schema : control"
          [nzShape]="schema.shape"
          [nzSize]="schema.size"
          [nzType]="schema.subtype">
          <ng-container *ngTemplateOutlet="buttonContentTemplate; context: { schema }"></ng-container>
        </button>
      </ng-container>
    </ng-container>
  </ng-container>
</ng-template>

<!-- 可组合的组件模板 -->
<!-- 根据 schema.type 来输出不同的控件 -->
<!-- @param control FormControl -->
<!-- @param schema  组件的图示 -->
<!-- @param model   当前模型值 -->
<ng-template #composableControlTemplate let-control="control" let-schema="schema" let-model="model" let-classful="classful">
  <ng-container
    *ngIf="!(schema.hidden | call: model : schema : control)"
    [ngSwitch]="schema.type">
    <ng-container *ngSwitchCase="'input'">
      <ng-container *ngIf="schema.autocomplete as autocomplete">
        <input
          nz-col
          nz-input
          [attr.id]="schema.id"
          [attr.maxlength]="schema.length?.max ?? schema.length"
          [attr.minlength]="schema.length?.min ?? schema.length"
          [fluentBinderSchema]="schema"
          [fluentBinderControl]="control"
          [formControl]="control"
          [ngClass]="classful ? schema.class : null"
          [ngStyle]="schema.style"
          [nzAutocomplete]="autocompleteCmp"
          [nzFlex]="schema.flex"
          [nzOffset]="schema.offset"
          [nzSpan]="schema.span ?? null"
          [placeholder]="schema.placeholder ?? ''"
          [type]="schema.subtype ?? 'text'"
          [autofocus]="schema.autofocus"
          [readonly]="schema.readonly | call: model : schema : control"
          [nzSize]="schema.size"
          [nzBorderless]="schema.borderless">
        <nz-autocomplete
          #autocompleteCmp
          [compareWith]="autocomplete.compare"
          [nzBackfill]="autocomplete.backfill"
          [nzDataSource]="autocomplete.options"
          [nzWidth]="autocomplete.width"></nz-autocomplete>
      </ng-container>
      <input
        *ngIf="!schema.autocomplete"
        nz-col
        nz-input
        [attr.id]="schema.id"
        [attr.maxlength]="schema.length?.max ?? schema.length"
        [attr.minlength]="schema.length?.min ?? schema.length"
        [fluentBinderSchema]="schema"
        [fluentBinderControl]="control"
        [formControl]="control"
        [ngClass]="classful ? schema.class : null"
        [ngStyle]="schema.style"
        [nzFlex]="schema.flex"
        [nzOffset]="schema.offset"
        [nzSpan]="schema.span ?? null"
        [placeholder]="schema.placeholder ?? ''"
        [type]="schema.subtype ?? 'text'"
        [autofocus]="schema.autofocus"
        [readonly]="schema.readonly | call: model : schema : control"
        [nzSize]="schema.size"
        [nzBorderless]="schema.borderless">
    </ng-container>

    <ng-container *ngSwitchCase="'textarea'">
      <ng-container *ngIf="schema.autocomplete as autocomplete">
        <textarea
          nz-col
          nz-input
          [attr.id]="schema.id"
          [attr.maxlength]="schema.length?.max ?? schema.length"
          [attr.minlength]="schema.length?.min ?? schema.length"
          [fluentBinderSchema]="schema"
          [fluentBinderControl]="control"
          [formControl]="control"
          [ngClass]="classful ? schema.class : null"
          [ngStyle]="schema.style"
          [nzAutocomplete]="autocompleteCmp"
          [nzAutosize]="schema.autosize ?? {}"
          [nzFlex]="schema.flex"
          [nzOffset]="schema.offset"
          [nzSpan]="schema.span ?? null"
          [placeholder]="schema.placeholder ?? ''"
          [rows]="schema.rows"
          [autofocus]="schema.autofocus"
          [readonly]="schema.readonly | call: model : schema : control"
          [nzSize]="schema.size"
          [nzBorderless]="schema.borderless"></textarea>
        <nz-autocomplete
          #autocompleteCmp
          [compareWith]="autocomplete.compare"
          [nzBackfill]="autocomplete.backfill"
          [nzDataSource]="autocomplete.options"
          [nzWidth]="autocomplete.width"></nz-autocomplete>
      </ng-container>
      <textarea
        *ngIf="!schema.autocomplete"
        nz-col
        nz-input
        [attr.id]="schema.id"
        [attr.maxlength]="schema.length?.max ?? schema.length"
        [attr.minlength]="schema.length?.min ?? schema.length"
        [fluentBinderSchema]="schema"
        [fluentBinderControl]="control"
        [formControl]="control"
        [ngClass]="classful ? schema.class : null"
        [ngStyle]="schema.style"
        [nzAutosize]="schema.autosize ?? {}"
        [nzFlex]="schema.flex"
        [nzOffset]="schema.offset"
        [nzSpan]="schema.span ?? null"
        [placeholder]="schema.placeholder ?? ''"
        [rows]="schema.rows"
        [autofocus]="schema.autofocus"
        [readonly]="schema.readonly | call: model : schema : control"
        [nzSize]="schema.size"
        [nzBorderless]="schema.borderless"></textarea>
    </ng-container>

    <ng-container *ngSwitchCase="'number'">
      <nz-input-number
        #cmp
        nz-col
        [fluentBinder]="cmp"
        [fluentBinderSchema]="schema"
        [fluentBinderControl]="control"
        [formControl]="control"
        [ngClass]="classful ? schema.class : null"
        [ngStyle]="schema.style"
        [nzFlex]="schema.flex"
        [nzId]="schema.id"
        [nzMax]="schema.max ?? infinity"
        [nzMin]="schema.min ?? -infinity"
        [nzOffset]="schema.offset"
        [nzPlaceHolder]="schema.placeholder ?? ''"
        [nzPrecision]="schema.precision ?? ''"
        [nzPrecisionMode]="schema.precisionMode"
        [nzSpan]="schema.span ?? null"
        [nzStep]="schema.step ?? 1"
        [nzAutoFocus]="schema.autofocus"
        [nzReadOnly]="schema.readonly | call: model : schema : control"
        [nzSize]="schema.size"
        [nzBorderless]="schema.borderless">
      </nz-input-number>
    </ng-container>

    <ng-container *ngSwitchCase="'date'">
      <nz-date-picker
        #cmp
        nz-col
        [fluentBinder]="cmp"
        [fluentBinderSchema]="schema"
        [fluentBinderControl]="control"
        [formControl]="control"
        [ngClass]="classful ? schema.class : null"
        [ngStyle]="schema.style"
        [nzAllowClear]="schema.clearable"
        [nzFlex]="schema.flex"
        [nzFormat]="schema.format"
        [nzId]="schema.id"
        [nzInline]="schema.inline"
        [nzMode]="schema.mode"
        [nzOffset]="schema.offset"
        [nzPlaceHolder]="schema.placeholder"
        [nzShowTime]="schema.time"
        [nzSpan]="schema.span ?? null"
        [nzShowTime]="schema.time"
        [nzBackdrop]="schema.backdrop"
        [nzPlacement]="schema.placement ?? 'bottomLeft'"
        [nzSuffixIcon]="schema.suffixIcon ?? 'calendar'"
        [nzAutoFocus]="schema.autofocus"
        [nzInputReadOnly]="schema.readonly | call: model : schema : control"
        [nzSize]="schema.size"
        [nzBorderless]="schema.borderless"
        [nzShowToday]="schema.today ?? true"
        [nzShowNow]="schema.now ?? true"></nz-date-picker>
    </ng-container>

    <ng-container *ngSwitchCase="'range'">
      <nz-range-picker
        #cmp
        nz-col
        [fluentBinder]="cmp"
        [fluentBinderSchema]="schema"
        [fluentBinderControl]="control"
        [formControl]="control"
        [ngClass]="classful ? schema.class : null"
        [ngStyle]="schema.style"
        [nzAllowClear]="schema.clearable"
        [nzFlex]="schema.flex"
        [nzFormat]="schema.format"
        [nzId]="schema.id"
        [nzInline]="schema.inline"
        [nzMode]="schema.mode"
        [nzOffset]="schema.offset"
        [nzPlaceHolder]="schema.placeholder"
        [nzShowTime]="schema.time"
        [nzSpan]="schema.span ?? null"
        [nzShowTime]="schema.time"
        [nzBackdrop]="schema.backdrop"
        [nzPlacement]="schema.placement ?? 'bottomLeft'"
        [nzSuffixIcon]="schema.suffixIcon ?? 'calendar'"
        [nzAutoFocus]="schema.autofocus"
        [nzInputReadOnly]="schema.readonly | call: model : schema : control"
        [nzSize]="schema.size"
        [nzBorderless]="schema.borderless"
        [nzShowToday]="schema.today ?? true"
        [nzShowNow]="schema.now ?? true"
        [nzSeparator]="schema.separator"></nz-range-picker>
    </ng-container>

    <ng-container *ngSwitchCase="'time'">
      <nz-time-picker
        #cmp
        nz-col
        [fluentBinder]="cmp"
        [fluentBinderSchema]="schema"
        [fluentBinderControl]="control"
        [formControl]="control"
        [ngClass]="classful ? schema.class : null"
        [ngStyle]="schema.style"
        [nzAllowEmpty]="schema.clearable"
        [nzFlex]="schema.flex"
        [nzFormat]="schema.format ?? 'HH:mm:ss'"
        [nzHourStep]="schema.step?.hour"
        [nzId]="schema.id"
        [nzMinuteStep]="schema.step?.minute"
        [nzOffset]="schema.offset"
        [nzPlaceHolder]="schema.placeholder"
        [nzSecondStep]="schema.step?.second"
        [nzSpan]="schema.span ?? null"
        [nzAutoFocus]="schema.autofocus"
        [nzSize]="schema.size"
        [nzBorderless]="schema.borderless"
        [nzBackdrop]="schema.backdrop"
        [nzSuffixIcon]="schema.suffixIcon ?? 'clock-circle'">
      </nz-time-picker>
    </ng-container>

    <ng-container *ngSwitchCase="'select'">
      <nz-select
        #cmp
        nz-col
        [fluentBinder]="cmp"
        [fluentBinderSchema]="schema"
        [fluentBinderControl]="control"
        [formControl]="control"
        [ngClass]="classful ? schema.class : null"
        [ngStyle]="schema.style"
        [nzAllowClear]="schema.clearable"
        [nzFlex]="schema.flex"
        [nzId]="schema.id"
        [nzMaxMultipleCount]="schema.limit ?? infinity"
        [nzMode]="schema.mode ?? 'default'"
        [nzOffset]="schema.offset"
        [nzPlaceHolder]="schema.placeholder"
        [nzShowSearch]="schema.searchable"
        [nzSpan]="schema.span ?? null"
        [nzShowSearch]="schema.searchable"
        [nzBackdrop]="schema.backdrop"
        [nzBorderless]="schema.borderless"
        [nzAutoFocus]="schema.autofocus"
        [nzShowArrow]="schema.arrow ?? (!schema.mode || schema.mode === 'default')"
        [nzSize]="schema.size"
        [nzSuffixIcon]="schema.suffixIcon">
        <nz-option
          *ngFor="let option of schema.options"
          [nzDisabled]="option[schema.config?.disabledProperty ?? 'disabled']"
          [nzLabel]="option[schema.config?.labelProperty ?? 'label']"
          [nzValue]="option[schema.config?.valueProperty ?? 'value']">
        </nz-option>
      </nz-select>
    </ng-container>

    <ng-container *ngSwitchCase="'cascader'">
      <nz-cascader
        #cmp
        nz-col
        [fluentBinder]="cmp"
        [fluentBinderSchema]="schema"
        [fluentBinderControl]="control"
        [formControl]="control"
        [ngClass]="classful ? schema.class : null"
        [ngStyle]="schema.style"
        [nzAllowClear]="schema.clearable ?? true"
        [nzAutoFocus]="schema.autofocus"
        [nzBackdrop]="schema.backdrop"
        [nzExpandIcon]="schema.expandIcon"
        [nzExpandTrigger]="schema.trigger"
        [nzFlex]="schema.flex"
        [nzLabelProperty]="schema.config?.labelProperty ?? 'label'"
        [nzLoadData]="schema.loadData"
        [nzOffset]="schema.offset"
        [nzOptions]="schema.options"
        [nzPlaceHolder]="schema.placeholder ?? ' '"
        [nzShowArrow]="schema.arrow ?? true"
        [nzShowSearch]="schema.searchable"
        [nzSize]="schema.size"
        [nzSpan]="schema.span ?? null"
        [nzSuffixIcon]="schema.suffixIcon"
        [nzValueProperty]="schema.config?.valueProperty ?? 'value'">
      </nz-cascader>
    </ng-container>

    <ng-container *ngSwitchCase="'tree-select'">
      <nz-tree-select
        #cmp
        nz-col
        [nzId]="schema.id"
        [fluentBinder]="cmp"
        [fluentBinderSchema]="schema"
        [fluentBinderControl]="control"
        [formControl]="control"
        [ngClass]="classful ? schema.class : null"
        [ngStyle]="schema.style"
        [nzAllowClear]="schema.clearable ?? true"
        [nzBackdrop]="schema.backdrop"
        [nzShowIcon]="schema.icon"
        [nzShowSearch]="schema.searchable"
        [nzSize]="schema.size"
        [nzCheckable]="schema.checkable"
        [nzCheckStrictly]="schema.checkable?.strict"
        [nzShowExpand]="schema.expandIcon ?? true"
        [nzExpandedIcon]="schema.expandIcon"
        [nzShowLine]="schema.line"
        [nzAsyncData]="schema.async"
        [nzNodes]="schema.options"
        [nzDefaultExpandAll]="schema.expandAll"
        [nzExpandedKeys]="schema.expandedKeys"
        [nzMultiple]="schema.multiple"
        [nzVirtualHeight]="schema.virtual?.height"
        [nzVirtualItemSize]="schema.virtual?.itemSize ?? 28"
        [nzVirtualMaxBufferPx]="schema.virtual?.maxBufferPx ?? 500"
        [nzVirtualMinBufferPx]="schema.virtual?.minBufferPx ?? 28"
        [nzSpan]="schema.span ?? null"
        [nzFlex]="schema.flex"
        [nzOffset]="schema.offset"></nz-tree-select>
    </ng-container>

    <ng-container *ngSwitchCase="'button'">
      <ng-container *ngIf="schema.subtype === 'link'">
        <a
          nz-col
          nz-button
          [attr.id]="schema.id"
          [disabled]="schema.disabled"
          [fluentBinderSchema]="schema"
          [fluentBinderControl]="control"
          [ngClass]="classful ? schema.class : null"
          [ngStyle]="schema.style"
          [nzBlock]="schema.block"
          [nzDanger]="schema.danger"
          [nzFlex]="schema.flex"
          [nzGhost]="schema.ghost"
          [nzLoading]="schema.loading"
          [nzOffset]="schema.offset"
          [nzShape]="schema.shape"
          [nzSize]="schema.size"
          [nzSpan]="schema.span ?? null"
          [nzType]="schema.subtype">
          <ng-container *ngTemplateOutlet="buttonContentTemplate; context: { schema }"></ng-container>
        </a>
      </ng-container>
      <ng-container *ngIf="schema.subtype !== 'link'">
        <button
          nz-col
          nz-button
          [attr.id]="schema.id"
          [attr.type]="schema.mode"
          [disabled]="schema.disabled"
          [fluentBinderSchema]="schema"
          [ngClass]="classful ? schema.class : null"
          [ngStyle]="schema.style"
          [nzBlock]="schema.block"
          [nzDanger]="schema.danger"
          [nzFlex]="schema.flex"
          [nzGhost]="schema.ghost"
          [nzLoading]="schema.loading"
          [nzOffset]="schema.offset"
          [nzShape]="schema.shape"
          [nzSize]="schema.size"
          [nzSpan]="schema.span ?? null"
          [nzType]="schema.subtype">
          <ng-container *ngTemplateOutlet="buttonContentTemplate; context: { schema }"></ng-container>
        </button>
      </ng-container>
    </ng-container>
  </ng-container>
</ng-template>

<!-- 按钮内容模板 -->
<ng-template #buttonContentTemplate let-schema="schema">
  <i
    *ngIf="schema.icon"
    nz-icon
    [nzRotate]="schema.icon.rotate"
    [nzSpin]="schema.icon.spin"
    [nzTheme]="schema.icon.theme"
    [nzType]="schema.icon.type ?? schema.icon"></i>
  <ng-container *nzStringTemplateOutlet="schema.content">{{ schema.content }}</ng-container>
</ng-template>
